import{d as M,c as R,r as g,a as T,u as z,e as w,g as L,f as e,k as O,l as N,w as q,n as s,t as n,i as H,F as C,p as I,q as W,v as Y,s as A,m as G,j as h,x as J,_ as K}from"./index-rgW8kFI3.js";import{s as i}from"./supabase-TDJmcE2O.js";import{E as Q}from"./ErrorBox-DPivWWWK.js";import{D as X}from"./Dialogue-C4E2M4J_.js";import{g as $}from"./generate_uuid-DCpGMQ0y.js";const Z={style:{"font-size":"1.5rem",margin:"0"}},ee=["placeholder"],te={class:"new bouncy"},ae={class:"user"},oe={class:"userblock"},se=["src"],re={class:"projects"},ne={class:"big"},le={class:"project-panel"},ie={key:0,class:"blank"},ue=["onClick"],ce=M({__name:"Projects",props:{language:String},setup(B){const S=B,o=R(()=>{switch(S.language){case"en":return{projects:"Projects",new_project:"New Project",untitled_project:"Untitled Project",loading:"Loading...",no_project:"No Projects Found... Maybe create a new one?",project_name:"Project Name",sign_out:"Sign Out"};default:return{projects:"โปรเจกต์",project_name:"โปรเจกต์ชื่อว่า...",new_project:"สร้างโปรเจกต์ใหม่",untitled_project:"ไม่มีชื่อ",loading:"โหลดอยู่ค้าบ",no_project:"ไม่มีโปรเจกต์เลย... ลองสร้างก่อนไหม :]",sign_out:"ออกละ ไม่อยู่ละ"}}});let y=g(!1),f=g({}),u=null,l=g("");const b=z(),c=T();let U=i.auth.getUser().then(a=>{a.error&&(console.clear(),c.push("/sign-up"))});!b.hash&&!U?c.push("/sign-up"):(b.hash.slice(1).split("&")[0].split("=")[1],(async()=>{const{data:{user:a}}=await i.auth.getUser();f.value=a})());const k=()=>{y.value=!y.value},V=async()=>{let{error:a}=await i.auth.signOut();if(a)return u="You are stuck here. No changing.",u;c.push("/")},D=async a=>{k();const t=[{email:f.value.email,status:"owner"}],{data:d,error:p}=await i.from("Teams").insert([{team_members:t}]).select();if(p)return u="Please wait until we have a stable connection to the database.",p;const v=d[0].id;g(d[0].id);const{data:_,error:m}=await i.from("Projects").insert([{name:a??"Untitled Project",type:"slide",content:{metadata:{width:"1920px",height:"1080px"},data:[{id:$(),content:[{id:$(),tag:"h1",content:"Hello!",position:{x:69,y:420,w:420,h:69}}]}]},team_id:v}]).select();if(m)return u="Please wait until we have a stable connection to the database.",m;c.push(`/${_[0].type}/${_[0].id}`)},E=async a=>{c.push(`/${a.type}/${a.id}`)};let j=g({data:{},error:null});return(async()=>j.value=await i.from("Projects").select("name,id,type"))(),(a,t)=>{var d,p,v,_,m,x,P;return h(),w(C,null,[L(X,{title:o.value.new_project,opened:s(y)},{default:q(()=>[e("p",Z,n(o.value.project_name),1),e("form",{onSubmit:t[1]||(t[1]=G(r=>D(s(l)?s(l):o.value.no_project),["prevent"]))},[W(e("input",{type:"text",placeholder:o.value.untitled_project,"onUpdate:modelValue":t[0]||(t[0]=r=>A(l)?l.value=r:l=r)},null,8,ee),[[Y,s(l)]]),t[2]||(t[2]=e("br",null,null,-1)),t[3]||(t[3]=e("br",null,null,-1)),e("button",te,n(o.value.new_project+"!"),1)],32)]),_:1},8,["title","opened"]),e("div",ae,[e("div",oe,[e("img",{class:"profile",src:((p=(d=s(f))==null?void 0:d.user_metadata)==null?void 0:p.avatar_url)??"no",referrerpolicy:"no-referrer"},null,8,se),e("h1",null,n(((_=(v=s(f))==null?void 0:v.user_metadata)==null?void 0:_.name)??o.value.loading),1)]),e("button",{class:"sign-out",onClick:V},n(o.value.sign_out),1)]),e("div",re,[e("h1",ne,n(o.value.projects),1),e("button",{onClick:k,class:"bouncy"},[t[4]||(t[4]=e("i",{class:"fa-solid fa-add"},null,-1)),H(" "+n(o.value.new_project),1)])]),e("div",le,[(m=s(j))!=null&&m.data[0]?N("",!0):(h(),w("p",ie,n(o.value.no_project),1)),(h(!0),w(C,null,I((x=s(j))==null?void 0:x.data,(r,F)=>(h(),w("div",{class:"project bouncy",style:J(`--anim-order: ${F}`),onClick:de=>E(r)},[e("p",null,n((r==null?void 0:r.name)??"What the fuck is in ur config?"),1)],12,ue))),256))]),s(u)?(h(),O(Q,{key:0,msg:(P=s(j))==null?void 0:P.error},null,8,["msg"])):N("",!0)],64)}}}),fe=K(ce,[["__scopeId","data-v-83b55633"]]);export{fe as default};
