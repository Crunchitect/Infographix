import{d as F,c as M,r as g,b as f,e as y,g as R,w as T,q as o,f as e,t as n,k as L,n as C,F as $,s as O,m as q,u as H,h as W,v as Y,x as A,y as G,l as J,z as K,p as Q,j as X,_ as Z}from"./index-0ZN5_fvz.js";import{s as c}from"./supabase-4zJeW_wQ.js";import{E as ee}from"./ErrorBox-r4WN76Ws.js";import{D as te}from"./Dialogue-Xm5Y5TFJ.js";import{g as B}from"./generate_uuid-F73_iyBE.js";const k=i=>(Q("data-v-83b55633"),i=i(),X(),i),ae={style:{"font-size":"1.5rem",margin:"0"}},oe=["placeholder"],se=k(()=>e("br",null,null,-1)),ne=k(()=>e("br",null,null,-1)),re={class:"new bouncy"},le={class:"user"},ce={class:"userblock"},ie=["src"],ue={class:"projects"},de={class:"big"},pe=k(()=>e("i",{class:"fa-solid fa-add"},null,-1)),_e={class:"project-panel"},me={key:0,class:"blank"},he=["onClick"],ge=F({__name:"Projects",props:{language:String},setup(i){const U=i,a=M(()=>{switch(U.language){case"en":return{projects:"Projects",new_project:"New Project",untitled_project:"Untitled Project",loading:"Loading...",no_project:"No Projects Found... Maybe create a new one?",project_name:"Project Name",sign_out:"Sign Out"};default:return{projects:"โปรเจกต์",project_name:"โปรเจกต์ชื่อว่า...",new_project:"สร้างโปรเจกต์ใหม่",untitled_project:"ไม่มีชื่อ",loading:"โหลดอยู่ค้าบ",no_project:"ไม่มีโปรเจกต์เลย... ลองสร้างก่อนไหม :]",sign_out:"ออกละ ไม่อยู่ละ"}}});let b=g(!1),j=g({}),u=null,r=g("");const x=H(),d=W();let V=c.auth.getUser().then(t=>{t.error&&(console.clear(),d.push("/sign-up"))});!x.hash&&!V?d.push("/sign-up"):(x.hash.slice(1).split("&")[0].split("=")[1],(async()=>{const{data:{user:t}}=await c.auth.getUser();j.value=t})());const P=()=>{b.value=!b.value},D=async()=>{let{error:t}=await c.auth.signOut();if(t)return u="You are stuck here. No changing.",u;d.push("/")},I=async t=>{P();const l=[{email:j.value.email,status:"owner"}],{data:p,error:_}=await c.from("Teams").insert([{team_members:l}]).select();if(_)return u="Please wait until we have a stable connection to the database.",_;const w=p[0].id;g(p[0].id);const{data:m,error:h}=await c.from("Projects").insert([{name:t??"Untitled Project",type:"slide",content:{metadata:{width:"1920px",height:"1080px"},data:[{id:B(),content:[{id:B(),tag:"h1",content:"Hello!",position:{x:69,y:420,w:420,h:69}}]}]},team_id:w}]).select();if(h)return u="Please wait until we have a stable connection to the database.",h;d.push(`/${m[0].type}/${m[0].id}`)},z=async t=>{d.push(`/${t.type}/${t.id}`)};let v=g({data:{},error:null});return(async()=>v.value=await c.from("Projects").select("name,id,type"))(),(t,l)=>{var p,_,w,m,h,N,S;return f(),y($,null,[R(te,{title:a.value.new_project,opened:o(b)},{default:T(()=>[e("p",ae,n(a.value.project_name),1),e("form",{onSubmit:l[1]||(l[1]=J(s=>I(o(r)?o(r):a.value.no_project),["prevent"]))},[Y(e("input",{type:"text",placeholder:a.value.untitled_project,"onUpdate:modelValue":l[0]||(l[0]=s=>G(r)?r.value=s:r=s)},null,8,oe),[[A,o(r)]]),se,ne,e("button",re,n(a.value.new_project+"!"),1)],32)]),_:1},8,["title","opened"]),e("div",le,[e("div",ce,[e("img",{class:"profile",src:((_=(p=o(j))==null?void 0:p.user_metadata)==null?void 0:_.avatar_url)??"no",referrerpolicy:"no-referrer"},null,8,ie),e("h1",null,n(((m=(w=o(j))==null?void 0:w.user_metadata)==null?void 0:m.name)??a.value.loading),1)]),e("button",{class:"sign-out",onClick:D},n(a.value.sign_out),1)]),e("div",ue,[e("h1",de,n(a.value.projects),1),e("button",{onClick:P,class:"bouncy"},[pe,L(" "+n(a.value.new_project),1)])]),e("div",_e,[(h=o(v))!=null&&h.data[0]?C("",!0):(f(),y("p",me,n(a.value.no_project),1)),(f(!0),y($,null,O((N=o(v))==null?void 0:N.data,(s,E)=>(f(),y("div",{class:"project bouncy",style:K(`--anim-order: ${E}`),onClick:fe=>z(s)},[e("p",null,n((s==null?void 0:s.name)??"What the fuck is in ur config?"),1)],12,he))),256))]),o(u)?(f(),q(ee,{key:0,msg:(S=o(v))==null?void 0:S.error},null,8,["msg"])):C("",!0)],64)}}}),ke=Z(ge,[["__scopeId","data-v-83b55633"]]);export{ke as default};
